package com.newnetcom.anlyze;

import java.util.ArrayList;
import java.util.Date;
import java.util.List;
import java.util.Map;
//import java.util.Timer;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

//import org.slf4j.Logger;
//import org.slf4j.LoggerFactory;
//import com.newnetcom.anlyze.thread.UpdateHbaseMyTask;
//import com.newnetcom.anlyze.thread.UpdateRedisTask;
//import com.newnetcom.anlyze.utils.ByteUtils;
//import com.newnetcom.anlyze.anlyze.AnlyzeCans;
import com.newnetcom.anlyze.anlyze.AnlyzeMain;
import com.newnetcom.anlyze.anlyze.db.factory.DatabaseFactory;
import com.newnetcom.anlyze.beans.ProtocolBean;
import com.newnetcom.anlyze.beans.VehicleIndex;
import com.newnetcom.anlyze.config.PropertyResource;

import cn.ngsoc.hbase.util.pages.Esutil;
//import com.newnetcom.anlyze.thread.AnlyzeDataTask;
//import com.newnetcom.anlyze.thread.CheckCatchTask;
//import com.newnetcom.anlyze.thread.DataToKafKaTask;
//import com.newnetcom.anlyze.thread.MyTask;
//import com.newnetcom.anlyze.thread.RawDataMyTaskRun;

public class TestApp {
	// private static final Logger logger =
	// LoggerFactory.getLogger(TestApp.class);

	public static void main(String[] args) {
		// ByteUtils.toEscape(ByteUtils.hexStr2Bytes("7E00000000E802C001FE4342313039363902010000262D000028F03B07B2B43C0228002D004D01110B0E022F3400C01C00007B21FF18007E"));
		// logger.error("tet");
		// TODO Auto-generated method stub
		// UpdateHbaseMyTask sendData = new UpdateHbaseMyTask();
		// sendData.setDaemon(true);
		// sendData.start();
		// AnlyzeDataTask sendData1 = new AnlyzeDataTask();
		// sendData1.setDaemon(true);
		// sendData1.start();
		// UpdateRedisTask sendDataRedis = new UpdateRedisTask();
		// sendDataRedis.setDaemon(true);
		// sendDataRedis.start();
		//
		// RawDataMyTaskRun sendData2 = new RawDataMyTaskRun();
		// sendData2.setDaemon(true);
		// sendData2.start();
		//
		// DataToKafKaTask sendDataTask = new DataToKafKaTask();
		// sendDataTask.setDaemon(true);
		// sendDataTask.start();
		//
//		// Timer timer = new Timer();
		Map<String,String> config=	PropertyResource.getInstance().getProperties();
		DatabaseFactory.getDB(Integer.parseInt(config.get("databaseType")),"A2L");//1获取配置文件的分析类
		DatabaseFactory.getDB(Integer.parseInt(config.get("databaseType")),"CAN");
	long temp=System.currentTimeMillis();
	 ExecutorService executor = Executors.newFixedThreadPool(10);
//		// timer.schedule(new CheckCatchTask(), new Date(), 10000);
	for (int t=0;t<1;t++)
		{
//		
		ProtocolBean protocol = new ProtocolBean();
		protocol.setFIBER_UNID("27A67D545CFF4AE3AD4DF45AB94A7C18");
		//098E11E36A024692A257DB72306137FF
		protocol.setRAW_OCTETS(
				//"7E0705031F01529554513204A500420857350000504C19BE0B0D0E0D00000E0D504C19BF0C0D0F0D0B0D0E0D504C19C00C0D0B0D0E0D0B0D504C19C10B0D0E0D0E0D00004CFE52633000004000FFC0004CFE5262100000A000FFC000504C19D6100D110D110D110D504C19D7110D100D0F0D0F0D504C19D8100D100D100D100D504C19D90000110D100D100D504C19DA110D120D110D110D504C19DB110D130D100D130D504C19DC110D000000000000504C1A2A120D0F0D130D0F0D504C1A2B0F0D100D0000100D504C1A2C100D0F0D100D100D504C1A2D0F0D100D0F0D110D504C1A2E0F0D0F0D100D000058FF217B11F4151027644C1858FF227B000000000000000058FF247B5A014D014E01791D58FF257B4340421C0100000058FF297B0008520852010000504C1A43150D160D140D130D58FFA97B0000000000000000504C1A44120D140D120D140D504C1A45140D150D140D170D504C1A460000140D160D170D504C1A47130D160D120D160D504C1A48150D160D140D170D504C1A49120D000000000000504C1A5C0E0D0E0D0D0D120D504C1A5D0E0D100D00000E0D504C1A5E0E0D0E0D0E0D100D504C1A5F0D0D8D0D0E0D0D0D504C1A600C0D0F0D0F0D0000504C1A75130D150D150D120D504C1A76130D120D140D110D504C1A77130D100D130D130D504C1A780000120D120D130D504C1A79140D150D130D110D504C1A7A140D120D140D180D504C1A7B150D000000000000504C1A82120D120D110D120D504C1A83110D120D0000110D504C1A84120D100D0F0D110D504C1A85110D110D110D120D504C1A86100D120D100D000053CC16B24C18000000A80000504C1991320210276400420E504C1992740EB80BF00A0000504C19935F00AC0DAC0D8101504C1997FF00000000000000504C19981913191319131913504C1A083800390038003900504C1A093800390038003900504C1A183600370036003800504C1A193600370036003800504C19A40E0D120D120D110D504C19A5100D0F0D0E0D100D504C19A60D0D100D0E0D0F0D504C19A70000100D0F0D0E0D504C19A8100D0E0D0E0D100D504C19A90E0D110D0F0D100D504C19AA0F0D000000000000504C19BD0C0D100D0E0D0E0D697E"
				"7E0705031301525246185702F80041165652000058F501F054482502000500004CFE52635000000000C4000058F502F00D00D007C80000004CFE62523000006B082000005801A79C0100455A7D011C02204CFFCAD0AA55AA00000000004CFE5262500000A000FFC0005801A79B40C9FF480227700158FF217B01AE15342748000058FF227B000000000000000058FF247B4A014A014A010B9758FF257B494748020700000058FF297B0050C350C301000058FFA97B0000000000000000504C19936400D007B80B2C00504C19A4EB0CEA0CEC0CE90C504C19A5E90CE90CE90CEC0C504C19A6EA0CEB0CED0CEA0C504C19A7E80CEA0CEC0CEB0C504C19A8E90CE60CE70CE90C504C19ABE60CE50CE90CE80C504C19A9E90CE80CE70CE80C504C19AAE70CEA0CE90CE80C504C19ACE90CE90CE90CE90C504C19ADE80CE70CE60CE60C504C19AEE80CEA0C00000000504C19BDEF0CEC0CED0CEC0C504C19BEEC0CEC0CEC0CED0C504C19BFEB0CEA0CED0CEC0C504C19C0EA0CEA0CED0CEA0C504C19C1EC0CEB0CED0CEC0C504C19C2E90CE80CE90CE90C504C19C3E70CEB0CE80CE90C504C19C4EB0CE90CEC0CE80C504C19C5EA0CE90CE90CE80C504C19C6E80CE80CE90CE70C504C19C7E60CE90C00000000504C19D6EE0CED0CEE0CEC0C504C19D7ED0CEA0CEC0CEC0C504C19D8ED0CEC0CEE0CEC0C504C19D9EA0CED0CEC0CEC0C504C19DAEB0CEA0CE90CEA0C504C19DBE90CEA0CEA0CEB0C504C19DCEA0CEA0CEA0CEA0C504C19DDEC0CE90CEA0CEA0C504C19DEEB0CE90CEA0CEB0C504C19DFE90CE90CE80CE90C504C19E0E90CE70C00000000504C1A2AED0CED0CEA0CEA0C504C1A2BEA0CEA0CEA0CEB0C504C1A2CEC0CE80CE90CEA0C504C1A2DE90CE90CEA0CE90C504C1A2EE90CE90CEA0CE60C504C1A2FE70CE80CE90CE80C504C1A30E50CE80CE70CE80C504C1A31E90CE90CE70CE80C504C1A32E90CE70CE80CE60C504C1A33E60CE80CE70CE70C504C1A34E70CE50C00000000504C1A083F003F003F003F00504C1A183D003D003D003D0058FB711780800060008813074CFFC9D00A0A0000000000295801A79D00C8FF47022A000058FB7017015A00004E640037687E"
				);
		protocol.setProto_unid("AF27DA9036174426A2E2F7C19A9A959C");
		//AF27DA9036174426A2E2F7C19A9A959C
		//CD039E17A8E84137AF6DE1CDC172C274
		protocol.setUnid("098E11E36A024692A257DB72306137FF");//276D8F32B73946BFA2D3CBEAC0C65EC0
		protocol.setTIMESTAMP(String.valueOf(new Date().getTime()));
		
		//executor.
		new AnlyzeMain(protocol).run();
		
		//executor.execute(new AnlyzeMain(protocol));
	}
		System.out.println(System.currentTimeMillis()-temp);
		
		
//		List<VehicleIndex> vehicleIndexs=new ArrayList<>();
//		VehicleIndex temp=new VehicleIndex("ee",String.valueOf(new Date().getTime()));
//		vehicleIndexs.add(temp);
//		Esutil.addIndex("tst", "type", vehicleIndexs);

	}
}
