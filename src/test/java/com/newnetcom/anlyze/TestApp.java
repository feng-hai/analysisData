package com.newnetcom.anlyze;

import java.util.ArrayList;
import java.util.Date;
import java.util.List;
import java.util.Map;
//import java.util.Timer;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

//import org.slf4j.Logger;
//import org.slf4j.LoggerFactory;
//import com.newnetcom.anlyze.thread.UpdateHbaseMyTask;
//import com.newnetcom.anlyze.thread.UpdateRedisTask;
//import com.newnetcom.anlyze.utils.ByteUtils;
//import com.newnetcom.anlyze.anlyze.AnlyzeCans;
import com.newnetcom.anlyze.anlyze.AnlyzeMain;
import com.newnetcom.anlyze.anlyze.db.factory.DatabaseFactory;
import com.newnetcom.anlyze.beans.ProtocolBean;
import com.newnetcom.anlyze.beans.VehicleIndex;
import com.newnetcom.anlyze.config.PropertyResource;

import cn.ngsoc.hbase.util.pages.Esutil;
//import com.newnetcom.anlyze.thread.AnlyzeDataTask;
//import com.newnetcom.anlyze.thread.CheckCatchTask;
//import com.newnetcom.anlyze.thread.DataToKafKaTask;
//import com.newnetcom.anlyze.thread.MyTask;
//import com.newnetcom.anlyze.thread.RawDataMyTaskRun;

public class TestApp {
	// private static final Logger logger =
	// LoggerFactory.getLogger(TestApp.class);

	public static void main(String[] args) {
		// ByteUtils.toEscape(ByteUtils.hexStr2Bytes("7E00000000E802C001FE4342313039363902010000262D000028F03B07B2B43C0228002D004D01110B0E022F3400C01C00007B21FF18007E"));
		// logger.error("tet");
		// TODO Auto-generated method stub
		// UpdateHbaseMyTask sendData = new UpdateHbaseMyTask();
		// sendData.setDaemon(true);
		// sendData.start();
		// AnlyzeDataTask sendData1 = new AnlyzeDataTask();
		// sendData1.setDaemon(true);
		// sendData1.start();
		// UpdateRedisTask sendDataRedis = new UpdateRedisTask();
		// sendDataRedis.setDaemon(true);
		// sendDataRedis.start();
		//
		// RawDataMyTaskRun sendData2 = new RawDataMyTaskRun();
		// sendData2.setDaemon(true);
		// sendData2.start();
		//
		// DataToKafKaTask sendDataTask = new DataToKafKaTask();
		// sendDataTask.setDaemon(true);
		// sendDataTask.start();
		//
//		// Timer timer = new Timer();
		Map<String,String> config=	PropertyResource.getInstance().getProperties();
		DatabaseFactory.getDB(Integer.parseInt(config.get("databaseType")),"A2L");//1获取配置文件的分析类
		DatabaseFactory.getDB(Integer.parseInt(config.get("databaseType")),"CAN");
	long temp=System.currentTimeMillis();
	 ExecutorService executor = Executors.newFixedThreadPool(10);
//		// timer.schedule(new CheckCatchTask(), new Date(), 10000);
	for (int t=0;t<1;t++)
		{
//		
		ProtocolBean protocol = new ProtocolBean();
		protocol.setFIBER_UNID("27A67D545CFF4AE3AD4DF45AB94A7C18");
		//098E11E36A024692A257DB72306137FF
		protocol.setRAW_OCTETS(
				//"7E0705031F01529554513204A500420857350000504C19BE0B0D0E0D00000E0D504C19BF0C0D0F0D0B0D0E0D504C19C00C0D0B0D0E0D0B0D504C19C10B0D0E0D0E0D00004CFE52633000004000FFC0004CFE5262100000A000FFC000504C19D6100D110D110D110D504C19D7110D100D0F0D0F0D504C19D8100D100D100D100D504C19D90000110D100D100D504C19DA110D120D110D110D504C19DB110D130D100D130D504C19DC110D000000000000504C1A2A120D0F0D130D0F0D504C1A2B0F0D100D0000100D504C1A2C100D0F0D100D100D504C1A2D0F0D100D0F0D110D504C1A2E0F0D0F0D100D000058FF217B11F4151027644C1858FF227B000000000000000058FF247B5A014D014E01791D58FF257B4340421C0100000058FF297B0008520852010000504C1A43150D160D140D130D58FFA97B0000000000000000504C1A44120D140D120D140D504C1A45140D150D140D170D504C1A460000140D160D170D504C1A47130D160D120D160D504C1A48150D160D140D170D504C1A49120D000000000000504C1A5C0E0D0E0D0D0D120D504C1A5D0E0D100D00000E0D504C1A5E0E0D0E0D0E0D100D504C1A5F0D0D8D0D0E0D0D0D504C1A600C0D0F0D0F0D0000504C1A75130D150D150D120D504C1A76130D120D140D110D504C1A77130D100D130D130D504C1A780000120D120D130D504C1A79140D150D130D110D504C1A7A140D120D140D180D504C1A7B150D000000000000504C1A82120D120D110D120D504C1A83110D120D0000110D504C1A84120D100D0F0D110D504C1A85110D110D110D120D504C1A86100D120D100D000053CC16B24C18000000A80000504C1991320210276400420E504C1992740EB80BF00A0000504C19935F00AC0DAC0D8101504C1997FF00000000000000504C19981913191319131913504C1A083800390038003900504C1A093800390038003900504C1A183600370036003800504C1A193600370036003800504C19A40E0D120D120D110D504C19A5100D0F0D0E0D100D504C19A60D0D100D0E0D0F0D504C19A70000100D0F0D0E0D504C19A8100D0E0D0E0D100D504C19A90E0D110D0F0D100D504C19AA0F0D000000000000504C19BD0C0D100D0E0D0E0D697E"
				"7E00000000E802EC02D00C43333136393601020000040600006A76EB06B699720100004B00AA00120116032E110101306400A7A1030C00083E6A2754006A5A6400A7A1040C009F81FF00000200716400A7A1050C000D104A80288047006400A7A1060C0004000000E47200006400A7A1070C0000000000000000000A00A1A7190C0060000102B41EBA1D6400A7A2020C00083EA0825555AA00B00409A7000C00040000003300FFFFB00409A7010C0080C20000FFFFFFFFB00409A7030C000D5E0000FFFFFFFFB00409A7040C002C0A14144412AD09B00409A7050C00E809FFFFFFFFFFFFB00409A7060C00FFFF89FEFFFFFFFFB00409A7070C00FFFF15006A160308B00409A7090C00FFFFFFFFFFFF2568B00409A70A0C004B004100C500FFFFB00409A70B0C003C1E000073C3FFFFB00409A70C0C00FFFFFFFFC3AD0000B00409A70F0C00056C000071560000B00409A7100C000000000000000000B00409A7110C002A000000FFFFFFFFB00409A7120C00412B000065120000B00409A7130C000601000064DDFFFFB00409A7170C00E10C0000FA950000B00409A7180C009BDBFFFFFFFFFFFFB00409A71A0C00FFFFFFFFE72D0000B00409A71B0C008A270000907700006400A7F4010C000000000000000072640090A70818000000000000000000640090A709180000000000000000006400A7900118000000000000000000F401F3D0181800F33DA8276A000002F401A7F3FF0C000021FFFFFFFFFFFFC800F3280018009A56289B5628FFFFC800F328011800F55628F65628FFFFC800F3280218005E5628C55428FFFFC800F328031800D65428BB5428FFFFC800F328041800CA54282D5428FFFFC800F42800180049FF49FF49FF49FFC800F42801180049FF90F648424B42C800F4280218006C426F42FFFFFFFF6400F4A7080C0000000000000000006400A7A1080C00FF0105330700006D640009A702180000000000000000006400A7A1190C0000000000000000006400A7A2010C00AB819218808C00166400F3D0191800901A5834005528496400F3D01A1800B402E203562854288A087E"
				);
		protocol.setProto_unid("CD039E17A8E84137AF6DE1CDC172C274");
		//AF27DA9036174426A2E2F7C19A9A959C
		//CD039E17A8E84137AF6DE1CDC172C274
		protocol.setUnid("276D8F32B73946BFA2D3CBEAC0C65EC0");
		protocol.setTIMESTAMP(String.valueOf(new Date().getTime()));
		
		//executor.
		new AnlyzeMain(protocol).run();
		
		//executor.execute(new AnlyzeMain(protocol));
	}
		System.out.println(System.currentTimeMillis()-temp);
		
		
//		List<VehicleIndex> vehicleIndexs=new ArrayList<>();
//		VehicleIndex temp=new VehicleIndex("ee",String.valueOf(new Date().getTime()));
//		vehicleIndexs.add(temp);
//		Esutil.addIndex("tst", "type", vehicleIndexs);

	}
}
